{% extends 'base.html' %}
{% block content %}

<h2>Relatório de Erros de Importação</h2>

{% if erros %}
    <div class="alert-warning">
        <i class="fas fa-exclamation-triangle"></i>
        <p>A importação anterior resultou em <strong>{{ erros | length }} erro(s)</strong>. Abaixo estão os registros que não foram cadastrados e o motivo da falha.</p>
    </div>

    <div class="table-scroll-wrapper">
        <table class="table table-errors">
            <thead>
                <tr>
                    <th>Linha</th>
                    <th>Matrícula</th>
                    <th>Nome do Aluno</th>
                    <th>Motivo do Erro</th>
                </tr>
            </thead>
            <tbody>
                {% for erro in erros %}
                <tr>
                    <td>{{ erro.linha if erro.linha else 'N/A' }}</td>
                    <td>{{ erro.matricula if erro.matricula else 'N/A' }}</td>
                    <td>{{ erro.nome if erro.nome else 'Registro sem nome' }}</td>
                    <td class="error-msg">
                        <i class="fas fa-exclamation-circle"></i>
                        {{ erro.erro }}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <div class="download-section">
        <p>Você pode copiar esta tabela ou corrigir os erros no arquivo original e tentar importar novamente.</p>
    </div>
    
{% else %}
    <div class="empty-state">
        <i class="fas fa-check-circle"></i>
        <p>Não há erros recentes de importação para exibir.</p>
        <p class="subtitle">Todas as importações anteriores foram concluídas com sucesso!</p>
    </div>
{% endif %}

<div class="form-actions">
    <a href="{{ url_for('alunos_bp.importar_alunos') }}" class="button btn-primary">
        <i class="fas fa-upload"></i> Nova Importação
    </a>
    <a href="{{ url_for('alunos_bp.listar_alunos') }}" class="button btn-secondary">
        <i class="fas fa-arrow-left"></i> Voltar para Lista
    </a>
</div>

<style>
.alert-warning {
    background: #fff3cd;
    border: 2px solid #ffc107;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 25px;
    display: flex;
    align-items: center;
    gap: 15px;
}

.alert-warning i {
    font-size: 2em;
    color: #ffc107;
}

.alert-warning p {
    margin: 0;
    color: #856404;
}

.table-scroll-wrapper {
    overflow-x: auto;
    margin-bottom: 25px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.table-errors {
    width: 100%;
    background: white;
    border-collapse: collapse;
}

.table-errors th,
.table-errors td {
    border: 1px solid #e0e0e0;
    padding: 12px;
    text-align: left;
}

.table-errors th {
    background: #f8f9fa;
    font-weight: 600;
    color: #2c3e50;
}

.table-errors tbody tr:hover {
    background: #fff3cd;
}

.error-msg {
    color: #e74c3c;
    font-weight: 500;
}

.error-msg i {
    margin-right: 5px;
}

.download-section {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin-bottom: 25px;
    text-align: center;
}

.download-section p {
    color: #7f8c8d;
    margin: 0;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin-bottom: 25px;
}

.empty-state i {
    font-size: 4em;
    color: #27ae60;
    margin-bottom: 20px;
}

.empty-state p {
    color: #2c3e50;
    font-size: 1.2em;
    margin-bottom: 10px;
}

.empty-state .subtitle {
    color: #7f8c8d;
    font-size: 1em;
}

.form-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
}
</style>

{% endblock %}