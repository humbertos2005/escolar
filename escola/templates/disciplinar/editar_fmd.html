{% extends 'base.html' %}

{% block content %}
<div class="main-content-inner">
    <h2>Editar Ficha de Medida Disciplinar</h2>
    <p class="subtitle">FMD Nº {{ fmd.fmd_id }}</p>
    
    <form method="POST" class="form-rfo">
        <!-- Informações do Aluno -->
        <div class="form-section">
            <h3 class="section-title"><i class="fas fa-user-graduate"></i> Informações do Aluno</h3>
            <div class="form-group">
                <label>Aluno</label>
                <input type="text" class="form-control" value="{{ fmd.matricula }} - {{ fmd.nome_aluno }}" readonly>
            </div>
            <div class="form-group">
                <label>Série/Turma</label>
                <input type="text" class="form-control" value="{{ fmd.serie }} - {{ fmd.turma }}" readonly>
            </div>
        </div>

        <!-- Dados da FMD -->
        <div class="form-section">
            <h3 class="section-title"><i class="fas fa-clipboard-list"></i> Dados da Medida Disciplinar</h3>
            
            <div class="form-group">
                <label for="data_fmd">Data da FMD <span class="required">*</span></label>
                <input type="date" id="data_fmd" name="data_fmd" class="form-control" 
                       value="{{ fmd.data_fmd | data_br }}" required>
            </div>

            <div class="form-group">
                <label for="tipo_falta">Tipo de Falta <span class="required">*</span></label>
                <select id="tipo_falta" name="tipo_falta" class="form-control" required>
                    <option value="">Selecione...</option>
                    <option value="LEVE" {% if fmd.tipo_falta == 'LEVE' %}selected{% endif %}>LEVE</option>
                    <option value="MÉDIA" {% if fmd.tipo_falta == 'MÉDIA' %}selected{% endif %}>MÉDIA</option>
                    <option value="GRAVE" {% if fmd.tipo_falta == 'GRAVE' %}selected{% endif %}>GRAVE</option>
                </select>
            </div>

            <div class="form-group">
                <label for="medida_aplicada">Medida Aplicada <span class="required">*</span></label>
                <select id="medida_aplicada" name="medida_aplicada" class="form-control" required>
                    <option value="">Selecione a Medida...</option>
                    {% for key, value in medidas_map.items() %}
                    <option value="{{ key }} - {{ value }}" {% if fmd.medida_aplicada == key + ' - ' + value %}selected{% endif %}>
                        {{ key }} - {{ value }}
                    </option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="descricao_falta">Descrição da Falta <span class="required">*</span></label>
                <textarea id="descricao_falta" name="descricao_falta" class="form-control" 
                          rows="5" required>{{ fmd.descricao_falta }}</textarea>
            </div>

            <div class="form-group">
                <label for="observacoes">Observações</label>
                <textarea id="observacoes" name="observacoes" class="form-control" 
                          rows="3">{{ fmd.observacoes if fmd.observacoes else '' }}</textarea>
            </div>

            <div class="form-group">
                <label for="status">Status <span class="required">*</span></label>
                <select id="status" name="status" class="form-control" required>
                    <option value="ATIVA" {% if fmd.status == 'ATIVA' %}selected{% endif %}>ATIVA</option>
                    <option value="CUMPRIDA" {% if fmd.status == 'CUMPRIDA' %}selected{% endif %}>CUMPRIDA</option>
                    <option value="CANCELADA" {% if fmd.status == 'CANCELADA' %}selected{% endif %}>CANCELADA</option>
                </select>
            </div>
        </div>

        <!-- Ações -->
        <div class="form-actions">
            <button type="submit" class="button btn-success btn-lg">
                <i class="fas fa-save"></i> Salvar Alterações
            </button>
            <a href="{{ url_for('visualizacoes_bp.listar_fmd') }}" class="button btn-secondary btn-lg">
                <i class="fas fa-times"></i> Cancelar
            </a>
        </div>
    </form>
</div>

<style>
.main-content-inner {
    max-width: 900px;
    margin: 30px auto;
    padding: 30px;
    background-color: #ffffff;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
}

.subtitle {
    color: #7f8c8d;
    margin-bottom: 20px;
    font-size: 1.1em;
}

.form-section {
    background-color: #f9fbfd;
    border: 1px solid #e0e6ed;
    border-radius: 10px;
    padding: 25px;
    margin-bottom: 25px;
}

.section-title {
    color: #34495e;
    font-size: 1.5em;
    margin-bottom: 20px;
    border-bottom: 2px solid #e0e6ed;
    padding-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.section-title i {
    color: #3498db;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: #34495e;
}

.required {
    color: #e74c3c;
}

.form-control {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid #ced4da;
    border-radius: 8px;
    font-size: 1em;
    color: #495057;
    transition: border-color 0.2s, box-shadow 0.2s;
}

.form-control:focus {
    border-color: #80bdff;
    outline: 0;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
}

.form-control[readonly] {
    background-color: #f8f9fa;
    cursor: not-allowed;
}

textarea.form-control {
    resize: vertical;
}

.form-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #e9ecef;
}

.btn-lg {
    padding: 15px 40px;
    font-size: 1.1em;
}
</style>
{% endblock %}