{% extends 'base.html' %}
{% block content %}

<h2>Gerenciar Alunos</h2>

<div class="manage-tabs" style="max-width:1200px;margin:20px auto;">

  <div class="manage-tabs-nav" style="display:flex;gap:10px;margin-bottom:15px;">
      <button type="button" class="tab-btn active" data-tab="cadastrar" style="padding:10px 16px;border:1px solid #ddd;background:#fff;border-radius:6px;cursor:pointer;">Cadastrar Aluno</button>
      <button type="button" class="tab-btn" data-tab="importar" style="padding:10px 16px;border:1px solid #ddd;background:#f7f7f7;border-radius:6px;cursor:pointer;">Importar Alunos</button>
      <a href="{{ url_for('visualizacoes_bp.listar_alunos') }}" class="btn btn-outline-primary" style="padding:9px 14px;height:39px;align-self:center;">
          <i class="fas fa-eye"></i> Visualizar Alunos
      </a>
      {# <a href="{{ url_for('cadastros_bp.gerenciar_lideres') }}" class="btn btn-warning">Gerenciar Líderes</a> #}
  </div>

  <div class="manage-tabs-content">
    <div id="tab-cadastrar" class="tab-panel" style="display:block;">
      {% include 'cadastros/_adicionar_aluno_content.html' %}
    </div>

    <div id="tab-importar" class="tab-panel" style="display:none;">
      {% include 'cadastros/_importar_alunos_content.html' %}
    </div>
  </div>
</div>

<script>
// ativa aba via ?tab=importar ou ?tab=cadastrar
(function(){
  try {
    const params = new URLSearchParams(window.location.search);
    const tab = params.get('tab');
    if (tab) {
      document.querySelectorAll('.manage-tabs .tab-btn').forEach(b => {
        b.classList.remove('active'); b.style.background = '#f7f7f7';
      });
      const btn = document.querySelector('.manage-tabs .tab-btn[data-tab="'+tab+'"]');
      if (btn) { btn.classList.add('active'); btn.style.background = '#fff'; }
      document.querySelectorAll('.manage-tabs .tab-panel').forEach(function(p){
        p.style.display = (p.id === 'tab-' + tab) ? 'block' : 'none';
      });
    }
  } catch(e){ console.log(e); }
})();
</script>

<script>
(function(){
  try {
    var tabs = document.querySelectorAll('.manage-tabs .tab-btn');
    tabs.forEach(function(btn){
      btn.addEventListener('click', function(){
        tabs.forEach(function(b){ b.classList.remove('active'); b.style.background='#f7f7f7'; });
        this.classList.add('active');
        this.style.background = '#fff';
        var tab = this.getAttribute('data-tab');
        document.querySelectorAll('.manage-tabs .tab-panel').forEach(function(p){
          p.style.display = (p.id === 'tab-' + tab) ? 'block' : 'none';
        });
        // scroll to top of content area
        var el = document.querySelector('.manage-tabs');
        if (el) { el.scrollIntoView({behavior: 'smooth', block: 'start'}); }
      });
    });
  } catch(e) {
    console.log('Tabs init error', e);
  }
})();
</script>

{% endblock %}
